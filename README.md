Development sponsored by the kind folks at http://www.bresser.de, who had need of this module and
kindly agreed to release it under the GPLv3.

# CMSconnect - CMS connector for OXID eShop

CMSconnect is an OXID eShop module which enables the loading of content from any CMS
that can be made to output content in a valid XML document.

Features at-a-glance:

* Load content directly from OXID templates using the [{ cmsconnect_load }] tag.
* SEO snippet detection to enable in-place CMS content browsing
* Highly configurable sources. Access URLs can be configured to enable
accessing of CMS content both by a human-readable URL (e.g. `http://cms.corp.com/de/some/page/path`)
and directly by ID (e.g. `http://cms.corp.com/index.php?id=123&L=2`)
* Multilingual support
* Intelligent content caching
* Provides access to the underlying XML object
* Automagic URL rewriting

## Introduction

Once configured, CMSconnect provides access to arbitrary CMS content provided the content
can be access by *either of two methods*:

* A human-readable page path (such as the ones generated by `realurl` on CMS)
* Direct query parameter access (e.g. `index.php?id=3&L=3`), where a language parameter is
automatically added and the `id` and `L` parameters are fully customizable.

## Configuration

CMSconnect works by using configured *sources* in the OXID admin backend. A source is
(currently) tied to a shop and a language. A full source configuration consists of:

* A base URL, such as `http://cms.mysupershop.com/` (HTTP/HTTPS configured separately)
* A base path, used for path-based requests, such as `/shop/de/`
* An ID parameter name, used for ID-based requests, such as `id`. This must be the HTTP parameter (mainly
for GET/POST) used to access pages directly, for example with `http://cms.mysupershop.com/index.php?id=...`.
* A language query snippet, used for ID-based requests, such as `L=1`. This must be the complete
query snippet used to request a page in the desired language, for example with `http://cms.mysupershop.com/index.php?id=1&L=1`.
* (Optional) additional query snippets to be added to every request.
* (Optional) an SEO snippet such as `cms/de/` to enable the user to browse the CMS content from inside
OXID. If you want CMS content to be accessible at `http://www.mysupershop.com/cms/de/page/path`, use the
above SEO snippet.

The admin backend form provides a live preview of example URLs that would be constructed
from the configured settings.

## XML document structure

    <cms>
        <!-- Example content nodes for CMS -->
        <left>
            <![CDATA[ ... ]]>
        </left>
        <normal>
            <![CDATA[ ... ]]>
        </normal>
        <right>
            <![CDATA[ ... ]]>
        </right>
        <border>
            <![CDATA[ ... ]]>
        </border>
        
        <!-- Further content nodes -->
        <navigation>
            <![CDATA[ ... ]]>
        </navigation>
        <breadcrumb>
            <![CDATA[ ... ]]>
        </breadcrumb>

        <metadata>
            <keywords>
                <![CDATA[ ... ]]>
            </keywords>
            <title>
                <![CDATA[ ... ]]>
            </title>
            <description>
                <![CDATA[ ... ]]>
            </description>
        </metadata>
    </cms>

CMSconnect expects to find:

* A root object with an arbitrary name (`cms` in the example above)
* A `metadata` node
* Several content nodes

Apart from the root node, none of the nodes are actually mandatory, although malformed XML
or missing nodes (such as the `metadata` -> `title`) node may result in property access errors.

The content nodes may have any name apart from the reserved node names listed above.

The `navigation` node is ignored when retrieving content node arrays from pages (see below).

## Usage

### In templates

#### Using the CMSconnect object directly

The CMSconnect class can be obtained to access its methods directly:

    [{ assign var=oCmsxid value=$oViewConf->getCmsxid() }]
    
Following this, all public methods can be used directly, e.g. the following will return
the content of the `normal` node from the XML document returned by the page at `page/path`.
The supplied page path is relative to the configured source URL. By default, content
is returned from the source for the currently selected language.

    [{ $oCmsxid->getContent('normal', 'page/path') }]
    [{ $oCmsxid->getContentById('normal', 123) }]
    
To retrieve all content nodes as key/value array:

    [{ $oCmsxid->getContentArray('page/path') }]
    [{ $oCmsxid->getContentArrayById(123) }]

To retrieve ALL nodes (content nodes as well as `metadata`, `navigation`, etc.):

    [{ $oCmsxid->getContentArrayById(123, null, false) }]

See the public method reference below for a listing of all methods and their arguments.

#### Smarty tag

CMSconnect provides a smarty tag for quick and easy access without the necessity of handling
the CMSconnect object:

    // Load (e.g.) http://my.domain.corp/de/page/path
    [{ cmsconnect_load page="page/path" content="normal" }]
    
    // Load content from the XML node 'secondary' (e.g.) http://my.domain.corp/en/page/path
    [{ cmsconnect_load page="page/path" content="secondary" lang="en" }]
    
    // Load content from the relative URL page/path and assign to variable sMyContent
    [{ cmsconnect_load page="page/path" content="normal" assign="sMyContent" }]
    
    // Load the page at page/path and return all content nodes as an associative array by
    // omitting the "content" parameter
    [{ cmsconnect_load page="page/path" assign="aMyContent" }]
    
    // Output content from a node in the previously fetched content array
    [{ $aMyContent.normal }]
    
    // Iterate through the content nodes
    [{ foreach from=$aMyContent key=sNode item=sNodeContent }]
        Content of node [{ $sNode }]: <p>[{ $sNodeContent }]</p>
    [{ /foreach }]
    
    // Load content from page with ID 123
    [{ cmsconnect_load id=123 content="normal" }]

## CMSconnect public method reference

[CMSconnect API documentation](http://whefter.github.io/cmsxid)

## TOXID compatibility

# Contributing

* Fork the project
* Commit and push until you are happy with your contribution

# More info

Copyright (c) 2014-2016 William Hefter

This program and entire repository is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.
You should have received a copy of the GNU General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.
